== high-concurrency
:hardbreaks-option:

=== 衡量指标
- 吞吐量

    ▪ QPS
    ▪ TPS
    ▪ 并发数 PCU
    ▪ PV UV IP DAU MAU

- 响应时间

    ▪ 平均响应时间(AVG)
    ▪ 百分位数(Percentile)
    ▪ 秒开率
    ▪ 理论预估: https://colin-scott.github.io/personal_website/research/interactive_latency.html

=== 垂直扩展(Scale Up)
- 目标: 提升单机处理能力

- 硬件

    ▪ CPU/GPU/FPGA/ASIC
    ▪ SMP/NUMA/MPP
    ▪ SSD

- 缓存

    ▪ 本地缓存
    ▪ 远程缓存
    ▪ 集中式缓存
    ▪ 分布式缓存

- 异步

    ▪ 进程
    ▪ 线程
    ▪ 协程
    ▪ 同步原语
    ▪ 异步原语
    ▪ 同步方式进行异步编程

- 延迟执行

    ▪ 排队
    ▪ 限流
    ▪ 降级
    ▪ 熔断

- 调优

    ▪ 系统层调优
        ▪ CPU
        ▪ 内存
        ▪ IO
          ▪ 网络
          ▪ 磁盘
          ▪ 文件 
    ▪ 应用层调优
        ▪ 算法
        ▪ 数据库
        ▪ 缓存
        ▪ 并发优化
            ▪ share/immutalbe/copy/move
            ▪ lock优化
            ▪ cacheline
            ▪ lock-free
        ▪ 池化技术
            ▪ 连接池
            ▪ 内存池
            ▪ 对象池
            ▪ 线程池
        ▪ 批量处理

=== 水平扩展(Scale Out)
- 目标: 多节点提升整个系统处理能力

- 分布式

    ▪ 基础理论
        ▪ 集中式与分布式
            ▪ 时钟与事件顺序
        	▪ failure&timeout
        	▪ 常见异常类型: 服务器宕机/网络异常/磁盘故障 
        ▪ CAP
        ▪ BASE
        ▪ 分区容忍性
        ▪ 可用性
            ▪ 高可用架构
                ▪ 主备/主从/主主
                ▪ 集群和分区
                ▪ 异地多活
            ▪ 超时
            ▪ 幂等
            ▪ 雪崩
            ▪ 限流
            ▪ 排队
            ▪ 降级
            ▪ 熔断
            ▪ 隔离
            ▪ 热更新
            ▪ 热重启
            ▪ 回滚
            ▪ 灰度发布
        ▪ 一致性
            ▪ 分类
                ▪ 强一致
                    ▪ 线性一致性
                    ▪ 顺序一致性
                ▪ 弱一致
                    ▪ 因果一致性
                    ▪ 最终一致性
                ▪ 以客户端为中心的一致性
                    ▪ 单调读一致性(Monotonic-Read Consistency)
                    ▪ 单调写一致性(Monotonic-Write Consistency)
                    ▪ 读写一致性(Read-Your-Writes Consistency)
                    ▪ 写读一致性(Writes-Follow-Reads Consistency)
            ▪ 共识算法
                ▪ 2PC
                ▪ 3PC
                ▪ BFT/PBFT
                ▪ Paxos
                ▪ Raft
                ▪ Quorum NWR
                ▪ Gossip
                ▪ ZAB
        ▪ 分布方式
            ▪ 哈希
            ▪ 范围
            ▪ 数据量
            ▪ 一致性哈希
        ▪ 负载均衡
            ▪ 各层负载均衡
                ▪ 二层负载均衡
                ▪ 四层负载均衡
                ▪ 七层负载均衡
            ▪ 算法
                ▪ round-robin
                ▪ 加权/weight round-robin
                ▪ random
                ▪ 加权/weight random
                ▪ 通用hash
                ▪ 一致性/consistent hash
                ▪ least connection
                ▪ least time 最小平均响应时间(nginx商业版)
                ▪ locality aware
                ▪ 带状态的负载均衡(sticky connection)
        ▪ 可观测性
            ▪ 日志(Logging)
            ▪ 追踪(Tracing)
            ▪ 度量(Metrics)
    ▪ 分布式存储 
        ▪ 分布式文件系统
        ▪ 分布式键值系统
        ▪ 分布式表格系统
        ▪ 分布式数据库
        ▪ 分布式缓存
    ▪ 分布式计算
        ▪ 批量计算
        ▪ 流式计算
        ▪ 图计算
        ▪ 查询分析计算
    ▪ 分布式消息队列
    ▪ 分布式事务
        ▪ 基于回滚与补偿
            ▪ XA
            ▪ TCC
            ▪ SAGA
        ▪ 基于可靠消息最终一致性/重试幂等
            ▪ 本地事件表
            ▪ MQ非事务消息
            ▪ MQ事务消息
            ▪ 最大努力通知

- 层次

    ▪ 接入层scaleout
    ▪ 服务层scaleout
    ▪ Cache层scaleout
    ▪ DB层scaleout

- 状态

    ▪ 无状态易扩展
    ▪ 有状态不易扩展
        ▪ 配置文件有状态
        ▪ 内存/缓存有状态
        ▪ DB有状态
    ▪ 带状态的服务扩展
        ▪ 数据分区后sticky
        ▪ 复制(同步或异步)
        ▪ 集中式/分布式管理