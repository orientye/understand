= http-restful-api-convention
:hardbreaks-option:
:revnumber: 0.0.1
:revdate: 2023-07-26 20:04
:author: orient
:toc:
:homepage: http://orientye.com

<<<

== 主要思想

    GET - To retrieve a resource.
    POST - To create a resource, or to execute a complex operation on a resource.
    PUT - To update a resource.
    DELETE - To delete a resource.
    PATCH - To perform a partial update to a resource.
    
    用复数而不是单数
    用名字而不是动词

== 示例
好的示例:

    GET /users                获取用户列表
    POST /users               新增一个用户
    GET /users/1001           获取某个用户
    PUT /users/1001           修改某个用户
    DELETE /users/1001        删除某个用户
    GET /users/1001/comments  获取某个用户的某部分
    PATCH /users/1001         修改某个用户的某部分

不良示例:

    GET /user/1001
    GET /listAllUsers
    POST /user/create
    PUT /updateUser/1001
    GET /userComments/1001

== 所有项
GET /users

== 单项
- 增删改查
POST /users               新增一个用户
GET /users/1001           获取某个用户
PUT /users/1001           修改某个用户
DELETE /users/1001        删除某个用户

- 部分获取
GET /users/1001/comments  获取某个用户的某部分

- 部分更新
PATCH /users/1001         修改某个用户的某部分

== 条件(主键/非主键) 分页 排序
有三种做法:
(1) url path
(2) url query
(3) body

对于主键的条件，毫无疑问，是url path的一部分。
其它条件，优先考虑path, 其次是query, 不要考虑body。

分页示例:
GET	http://localhost:8000/users/offset/{offset}/limit/{limit}	Get All Users with Paging
参考: https://oatpp.io/examples/crud/#user-service

非主键示例:
GET /users/names/xyz123

== 批处理操作与批量操作
https://apifox.com/blog/adding-batch-or-bulk-to-rest-api/
https://apifox.com/blog/batch-requests/
https://apifox.com/blog/bulk-operations/
https://juejin.cn/post/6844903733696921607#heading-91

== upsert
使用PUT
https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.6
https://stackoverflow.com/questions/18470588/in-rest-is-post-or-put-best-suited-for-upsert-operation

== version
建议使用header
解读:
通常的做法是: (1)放在url作为path的一部分，或者(2)header
paypal放在url里path的起始位置，例如: POST /v1/vault/credit-cards
github则采用后者: https://docs.github.com/en/rest/overview/api-versions

== 结果
建议使用标准HTTP的Status返回状态码，此外还有msg(string类型)以及具体的data。

== 参考
https://docs.github.com/en/rest
https://github.com/paypal/api-standards
https://juejin.cn/post/6844903733696921607[papal]
https://developer.paypal.com/api/rest/
https://github.com/microsoft/api-guidelines
https://learn.microsoft.com/zh-cn/azure/architecture/best-practices/api-design
https://www.ruanyifeng.com/blog/2014/05/restful_api.html