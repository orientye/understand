= 了解rpc
:hardbreaks-option:
:revnumber: 0.0.1
:author: orient
:toc:
:homepage: http://orientye.com
<<<

== 概述

- 服务调用方式

    同步
    异步
    并行

- 协议

- 压缩与解压

- 加密与解密

== protobuf
https://developers.google.com/protocol-buffers/docs/proto3
https://halfrost.com/protobuf_encode/

=== 优化
▪ capnproto
核心思想: no encoding/decoding step
https://github.com/capnproto/capnproto

https://stackoverflow.com/questions/21854687/improving-performance-of-protocol-buffers

== gRPC

- 服务调用

	普通RPC调用
		同步阻塞，通常实现类xxxBlockingStub(基于proto定义生成)
		异步非阻塞，基于Future-Listener机制，通常实现类xxxFutureStub
		异步非阻塞，基于Reactive的响应编程模式，通常实现类是xxxStub

	基于HTTP/2.0的streaming调用方式
		服务端streaming: 例如短信群发功能
		客户端streaming: 例如汇总功能
		双向streaming 

即:
Unary RPC:    rpc simpleHello(Person) returns (Result) {}
Server streaming RPC:    rpc serverStreamHello(Person) returns (stream Result) {}
Client streaming RPC:     rpc clientStreamHello(stream Person) returns (Result) {}
Bidirectional streaming RPC:  rpc biStreamHello(stream Person) returns (stream Result) {}

https://grpc.io/docs/what-is-grpc/core-concepts/

cpp:
https://grpc.io/docs/languages/cpp/basics/
https://grpc.io/docs/languages/cpp/async/

== Thrift

== Spring Cloud

== brpc

== Dubbo

== tars

== PhxRPC

== srpc
https://github.com/sogou/srpc/tree/master/docs
https://github.com/sogou/workflow/tree/master/docs

Workflow:
FAQ: https://github.com/sogou/workflow/issues/170
https://www.zhihu.com/question/20124494/answer/2298649258
https://zhuanlan.zhihu.com/p/165638263
https://zhuanlan.zhihu.com/p/484293077

SRPC架构介绍: https://zhuanlan.zhihu.com/p/249071112

== flare

== 实战

=== 超时与重试
应用层可以从以下角度考虑:
TP99请求耗时: 超时时间设置和重传次数问题需要根据每一个服务TP99的请求耗时以及业务场景进行综合衡量。
RPC调用方式: 网关调用各下游服务的串并行方式，服务之间是否存在上下服务依赖。
分析核心服务: 区分核心与非核心服务，核心服务是否有备用方案，非核心服务是否有降级策略。
https://cloud.tencent.com/developer/article/1605116
https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E9%9D%A2%E8%AF%95%E7%B2%BE%E8%AE%B2/07%20%20RPC%EF%BC%9A%E5%A6%82%E4%BD%95%E5%9C%A8%E9%9D%A2%E8%AF%95%E4%B8%AD%E5%B1%95%E7%8E%B0%E5%87%BA%E2%80%9C%E9%80%A0%E8%BD%AE%E5%AD%90%E2%80%9D%E7%9A%84%E8%83%BD%E5%8A%9B%EF%BC%9F.md
