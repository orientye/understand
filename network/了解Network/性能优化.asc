:toc:
:toclevels: 4
:hardbreaks-option:

== 性能优化

=== 指标与工具
指标与工具:
[format="csv", options="header", separator=#]
|===
指标#工具
b(bit)ps吞吐量 #                      sar, nethogs, iftop                     
p(package)ps #                        sar, /proc/net/dev
连接数 #                              netstat, ss
延迟 #                                ping hping3
连接跟踪 #                            conntrack
路由 #                                mtr, route, traceroute
DNS #                                dig, nslookup
防火墙 #                              iptables, firewall-cmd
网卡功能#                             ethtool
丢包 #                                netstat, ifconfig, ethtool
抓包 #                                tcpdump, wireshark
内核协议栈追踪 #                       bcc, systemtap
内核协议栈剖析 #                       perf  
|===

=== 硬件层优化
▪ RDMA

=== 内核层优化
▪ 调小TCP协议的time_wait超时时间

    操作系统默认240秒后才会关闭处于time_wait状态的连接

▪ 调大服务器所支持的最大文件句柄数

    操作系统默认最大fd数量为1024

=== 应用层优化
▪ unix domain sockets
▪ io_uring
▪ QUIC   
▪ https://www.infoq.cn/article/netty-million-level-push-service-design-points
▪ DPDK与C10M

    C10M(单机1000万连接？)
    跳过内核协议栈的冗长路径，把网络包直接送到要处理的应用程序
    目前有两种机制: DPDK与XDP
