:toc:
:toclevels: 5
:hardbreaks-option:

=== spinlock

==== vs-mutex
特性	自旋锁 (spinlock)	互斥锁 (mutex)
等待机制	忙等待 (Busy-Waiting)	休眠等待 (Sleep-Waiting)
实现原理	线程在一个循环中不断检查锁是否可用（"旋转"）。	如果锁被占用，线程会进入休眠状态，让出CPU。
开销	获取锁失败时，消耗CPU周期。	线程切换有上下文切换的开销。
适用场景	临界区非常短、等待时间极短、多核系统。	临界区较长、等待时间可能较长、单核/多核均可。
性能特点	避免上下文切换，在预期很快能获取锁时效率高。	在锁竞争激烈或持有时间长时，能释放CPU资源给其他线程。

==== impl
===== linux kernel
https://github.com/orientye/understanding-the-linux-kernel/blob/main/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Linux%E5%86%85%E6%A0%B8/%E8%BF%9B%E7%A8%8B/%E5%90%8C%E6%AD%A5.asc#%E8%87%AA%E6%97%8B%E9%94%81

===== glibc
https://github.com/bminor/glibc/blob/master/mach/lock-intern.h

===== c
https://github.com/nginx/nginx/blob/master/src/core/ngx_spinlock.c

===== cpp
https://rigtorp.se/spinlock/
